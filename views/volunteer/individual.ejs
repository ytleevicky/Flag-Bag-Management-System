<title><%= name %> - 個人義工
</title>

<body>

  <div class="bordered2">
    <h1>個人義工</h1>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/management">活動管理</a></li>
        <li class="breadcrumb-item"><a href="/viewitem/<%= eventid %>"><%= name %></a></li>
        <li class="breadcrumb-item active" aria-current="page">個人義工</li>
      </ol>
    </nav>
  </div>

  <br>

  <div class="row">

    <div class="col col-sm-2 col-md-2">

      <div class="btn-group-vertical" role="group" aria-label="Basic example">
        <a href="/viewitem/<%= eventid %>" class="btn btn-info" role="button">活動摘要</a>
        <a href="/stationmgrDisplay/<%= eventid %>" class="btn btn-info" role="button">旗站管理員</a>
        <a href="/individual/<%= eventid %>" class="btn btn-info" role="button">個人義工</a>
        <a href="/group/<%= eventid %>" class="btn btn-info" role="button">團體義工</a>
        <a href="/station/<%= eventid %>" class="btn btn-info" role="button">旗站</a>
      </div>

    </div>

    <div class="col col-sm-10 col-md-10">

      <h2>管理個人義工</h2>
      <br>



      <div class="bordered">

        <p class="font-weight-bold" style="background-color:powderblue; padding: 10px; ">匯出團體義工（透過Excel）</p>

        <div class="row" style="padding: 20px;">

          <!-- <form action="/import_vIndividual" method="post" enctype="multipart/form-data">
          <div class="col-sm-6">
            <p>匯入Excel檔案：</p>
            <input type="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" name="file" />
            <input type="submit" class="btn btn-primary" />
          </div>
        </form> -->

          <div class="col-sm-6">
            <p>以Excel檔案匯出：</p>
            <a href="/export_vIndividual" class="btn btn-info">匯出</a>
          </div>

        </div>

      </div>

      <br>
      <form action="/printLabels" method="POST">
        <h3>個人義工列表</h3>
        <a href="/addIndividual" class="btn btn-primary">新增個人義工</a>
        <button type="submit" class="btn btn-success">列印選擇項目</button>
        <br>
        <table class="table table-bordered">
          <br>
          <thead>
            <tr>
              <th scope="col">
                <div class="form-check">
                  <input type="checkbox" onclick="check_all(this,'c')">
                  <!-- <label class="form-check-label" for="exampleCheck1"></label> -->
                </div>
              </th>
              <th scope="col">姓名</th>
              <!-- <th scope="col">聯絡電話</th> -->
              <th scope="col">旗站名稱</th>
              <!-- <th scope="col">旗站地區</th> -->
              <th scope="col">旗袋編號</th>
              <th scope="col">旗袋狀態</th>
              <!-- <th scope="col">旗袋最後更新時間</th>
          <th scope="col">最後列印標籤時間</th> -->
              <th scope="col">更多</th>
            </tr>
          </thead>

          <tbody>

            <% stations.forEach( function(model) { %>
            <tr>
              <th scope="row">
                <div class="form-check">
                  <input type="checkbox" class="checks" name="c" value="<%= model.id %>">
                  <!-- <label class="form-check-label" for="exampleCheck1"></label> -->
                </div>
              </th>
              <td><%= model.vName %></td>
              <!-- <td><%= model.vContact %></td> -->
              <td><%= model.within.length > 0 ? model.within[0].sName :''%></td>
              <!-- <td><%= model.sLocation %></td> -->
              <td><%= model.assignTo[0].bagNumber == "" ? '---' : model.assignTo[0].bagNumber %></td>
              <td><%= model.assignTo[0].bagStatus %></td>
              <!-- <td><%= model.bagUpdate %></td>
          <td><%= model.codePrintedTime %></td> -->
              <td>
                <a href='/viewIndividual/<%= model.id %>' class="btn btn-info">詳細</a>
                <button type="submit" class="btn btn-danger" onclick="deleteVolunteer('<%= model.id %>')">刪除</button>
                <a href='/printQRcode/<%= model.id %>' target="_blank" class="btn btn-success">列印</a>
              </td>
              <% }); %>
            </tr>

            <input type="hidden" id="inputCreatedBy" name="Volunteer[isContacter]" value="false">

          </tbody>
        </table>
      </form>
    </div>

</body>

<style>
  .bordered {
    width: 800;
    height: 800;
    border: 1px solid black;
    border-radius: 5px;
    border-color: powderblue;
  }

  .bordered2 {
    padding: 15px;
    padding-bottom: 1px;
    border: 1px solid gainsboro;
    border-radius: 5px;
  }
</style>

<script>

  function check_all(obj, cName) {
    var checkboxs = document.getElementsByName(cName);
    for (var i = 0; i < checkboxs.length; i++) { checkboxs[i].checked = obj.checked; }
  }

  // var totalNum = <%- stations.length %>;   // Don't auto-format on this line 

  // function getValue() {

  //   var checks = document.getElementsByClassName('checks');
  //   var str = '';

  //   for (i = 0; i < totalNum; i++) {

  //     if (checks[i].checked === true) {
  //       str += checks[i].value + " ";
  //     }

  //   }

  //   alert(str);

  // }


  async function deleteVolunteer(id) {

    var r = confirm("確認刪除個人義工?");

    if (r) {

      var response = await fetch("/volunteer/" + id, {
        method: "DELETE",
        credentials: 'same-origin',
      });

      if (response.ok) {
        var data = await response.json();
        alert(data.message);
        window.location = data.url;
      } else {
        alert(response.status + ": " + response.statusText);
      }

    } else {
      alert("取消");
    }

  };



</script>